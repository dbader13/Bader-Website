{{- define "main" -}}

<article class="article article-publication">
  <div class="article-container pt-3">
    
    {{/* Title */}}
    <h1 itemprop="name">{{ .Title }}</h1>

    {{/* Authors - display proper names */}}
    {{ with .Params.authors }}
    <div class="article-metadata">
      <span itemprop="author">
        {{- range $index, $author := . -}}
          {{- if $index }}, {{ end -}}
          {{- $author_slug := $author | urlize -}}
          {{- $author_page := site.GetPage (printf "/authors/%s" $author_slug) -}}
          {{- if $author_page -}}
            <a href="{{ $author_page.RelPermalink }}">{{ $author_page.Title }}</a>
          {{- else if eq $author "admin" -}}
            {{- $admin_page := site.GetPage "/authors/admin" -}}
            {{- if $admin_page -}}
              <a href="{{ $admin_page.RelPermalink }}">{{ $admin_page.Title }}</a>
            {{- else -}}
              {{ $author }}
            {{- end -}}
          {{- else -}}
            {{ $author }}
          {{- end -}}
        {{- end -}}
      </span>
    </div>
    {{ end }}

    {{/* Date */}}
    {{ with .Date }}
    <div class="article-metadata">
      {{ .Format "January, 2006" }}
    </div>
    {{ end }}

    {{/* Publication links */}}
    <div class="btn-links mb-3">
      {{ partial "page_links" (dict "page" . "is_list" 0) }}
    </div>

    {{/* Abstract */}}
    {{ with .Params.abstract }}
    <h3>Abstract</h3>
    <p class="pub-abstract">{{ . | markdownify }}</p>
    {{ end }}

    {{/* Type and Publication in table format */}}
    <table style="margin: 2rem 0 2rem 3rem; border-collapse: collapse; border: none; width: auto; font-size: 1.1rem;">
      {{ with .Params.publication_types }}
      <tr style="border: none;">
        <td style="padding: 0.2rem 2rem 0.2rem 0; font-weight: bold; vertical-align: top; white-space: nowrap; border: none;">Type</td>
        <td style="padding: 0.2rem 0; border: none;">
          {{ if eq (index . 0) "article-journal" }}Journal article
          {{ else if eq (index . 0) "paper-conference" }}Conference paper
          {{ else if eq (index . 0) "chapter" }}Book chapter
          {{ else if eq (index . 0) "book" }}Book
          {{ else }}{{ index . 0 }}{{ end }}
        </td>
      </tr>
      {{ end }}
      
      {{ with .Params.publication }}
      <tr style="border: none;">
        <td style="padding: 0.2rem 2rem 0.2rem 0; font-weight: bold; vertical-align: top; white-space: nowrap; border: none;">Publication</td>
        <td style="padding: 0.2rem 0; border: none;">{{ . | markdownify }}</td>
      </tr>
      {{ end }}
    </table>

    {{/* Content */}}
    <div class="article-style">
      {{ .Content }}
    </div>

  </div>
</article>

{{- end -}}
